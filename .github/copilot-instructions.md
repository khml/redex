# Copilot Instructions - redex

## プロジェクト概要

本リポジトリはRubyで実装する「シンプル言語処理系」を目的とした軽量ライブラリ/ツールの開発リポジトリです。
- 言語: Ruby 3.x 想定

---

## 開発前の必須確認事項

作業を開始する前に、以下のドキュメントを必ず確認してください。設計方針や前提条件が記載されています。

ドキュメントは `docs/` ディレクトリに格納されています。要件定義は特に以下を参照してください:

- 要件定義: docs/requirements/requirements_specification.md

以下の設計ドキュメントはアーキテクチャ設計と実装の一次参照です。作業開始前や設計判断が必要な場合は必ず参照してください。

- アーキテクチャ総覧: [docs/architecture.md](docs/architecture.md)
- アーキテクチャ図（資産）: [docs/assets/architecture.svg](docs/assets/architecture.svg)
- 設計決定ログ: [docs/decisions/0008_architecture_decision.md](docs/decisions/0008_architecture_decision.md)
- 仕様（EBNF）: [docs/ebnf.md](docs/ebnf.md)
- パーサ設計: [docs/parser.md](docs/parser.md)
- トークナイザ設計: [docs/tokenizer.md](docs/tokenizer.md)

ガイド:
- `docs/architecture.md` は主要コンポーネント、データフロー、`context`/`ruby_resolver` の統合仕様、テスト戦略を記載しています。実装やレビュー時はこのファイルを起点にしてください。
- アーキテクチャ図は素早い理解のための視覚資産です。必要に応じて `docs/assets/` 内の図を更新し、図の更新理由を `docs/decisions/` に記録してください。
- 重大な設計変更や方針決定は `docs/decisions/` にDecision Recordとして残してください。

開発環境やテスト実行手順は `README.md` と `spec/`（または `test/`）内のファイルを参照してください。

---

## チケット運用ルール

### チケット管理

- 全タスクは `tickets/` ディレクトリにテキストファイルとして管理します。
- ファイル名形式（必須）: `<4桁チケット番号>_<チケット名>.txt`（例: `0001_requirements.txt`, `0002_setup_structure.txt`）
- 親子関係の扱い: チケット間の関係はファイル内に明記してくださいが、ファイル名自体はすべて4桁形式とします（子チケットのための特別な命名形式は使用しません）。

### チケットステータス

- 完了したチケットの扱い:
    - ユーザーがチケット内に完了ステータスを記載する、または
    - ユーザーがファイルを `tickets/done/` ディレクトリに移動する
- 完了状態のチケットは再対応不要です。

---

## 開発規約

プロジェクト固有の簡易ルール:

- コードとドキュメントは日本語で記載（技術用語は英語可）。
 - ライブラリ配置: `lib/redex/` を想定。
- テスト: `spec/` を推奨（RSpec）。最小限のユニットテストを必須とする。

実装へのコメントは適切に行ってください。コメント内容は日本語で記載し、コードの意図や設計判断を明確に説明してください。  
MethodやClassのドキュメントコメントも同様に日本語で記載してください。YARD形式を推奨します。  

実装行う場合は、他の実装コードを参考にし、スタイルを揃えるようにしてください。  
ドキュメントの作成を行う場合も、同様に似た種類のドキュメントを確認し、構成などを揃えるようにしてください。  
specファイルを作成する場合は、既存のspecファイルを参考にしてください。テストケースごとにテスト観点や目的をコメントに日本語で記載するようにしてください。  

---

## 禁止事項

- **チケットステータスセクションの編集**: ユーザーのみが更新可能
- **完了チケットの再実装**: `tickets/done/` 内のチケットは対応しない
- **ドキュメント未確認での実装**: 必ず関連ドキュメントを確認してから作業

---

## コミュニケーション

### 言語

- **日本語のみ使用**: ユーザーとのやり取りは全て日本語で行う
- コード内コメント、ドキュメントも日本語を基本とする（英語の技術用語は適宜使用可）

### 質問・確認

- 要件が不明確な場合は、作業前に必ず確認
- 複数の解釈が可能な場合は、選択肢を提示して確認
- ドキュメントに記載がない仕様は、推測せずユーザーに確認

